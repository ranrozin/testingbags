
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">

    <title>Tags Management </title>


    <!-- Custom styles for this template -->
    <link href="css/signin.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy this line! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>
	  <div class="myhead">
		<a href="/logout">Logout</a>
	  </div>

    <div class="container">
	<div class="helper"></div>

      <form id="fsearch" class="form-search" role="form" action="/get_card" method="post">
        <h3>Search tags</h3>
        <div>
            <input id="ID" name="ID" type="search" class="form-control input-lg" placeholder="Enter ID or email to search" required autofocus >
            <button id="search" class="btn btn-lg btn-primary btn-block" type="submit">Search</button>
            <span id="error"></span>
        </div>
	  </form>
	  <hr>
	  <form class="form-search" role="form" action="/new" method="get">
		<button class="btn btn-lg btn-primary btn-block" type="submit">New</button>
      </form>

    </div> <!-- /container -->


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <script>	
	$('#fsearch').on('submit', function(event) {
	/*
	 I didn't find a nice way to have an ajax call on teh submit button, so the way I did it was to
	 do an ajax call to check if record exist, if yes, to repleace body, if not, the srevre returns error 202
	*/
		event.preventDefault();
		if ( $('#ID').val().length < 5) {
			alert ("ID should be at least 5 char");
		} else {
			var url = "/get_card"; // the script where you handle the form input.
			var term = $('#ID').val();
			var search = $.post(url,{ID: term});
			search.done (function(data){
				$('body').html(data);
			});
			search.fail(function(data) {
				if (data.status == 404) { // the server returns 202 error if there is no record
					$('#error').empty().html("No record was found, try again").addClass('error');
				} else {
					$('#error').empty().html("there was connection error").addClass('error');
							}
				event.preventDefault();
			});			
		}
	});	
		
	
    var emailRegex = /^\S+@\S+\.\S+$/;
    $('form #email').on("blur", function() {
      var p = $(this).parent();
      if (emailRegex.test($(this).val())) {
        p.removeClass('has-error');
        p.addClass('has-success');
        $(this).next('span').removeClass("glyphicon glyphicon-remove form-control-feedback");
        $(this).next('span').addClass("glyphicon glyphicon-ok form-control-feedback");
      }else {
        p.removeClass('has-success');
        p.addClass('has-error');
        $(this).next('span').removeClass("glyphicon glyphicon-ok form-control-feedback");
        $(this).next('span').addClass("glyphicon glyphicon-remove form-control-feedback");
      }
    });
    
    </script>
    
  </body>
</html>
